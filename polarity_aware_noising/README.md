# Polarity-Aware Denoising

## Overview
The idea of our pre-training schemeâ€”polarity-aware denoising is to first introduce noise, i.e. delete or mask a certain proportion of words ([see this](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/prepare_noisy_data/README.md)) in the intermediate German input to the back-translation step, then train the model to remove this noise, i.e. produce the original English sentence with no words deleted or masked.
We use polarity-aware denoising during encoder pretraining, following the shared encoder and separate decoders [setup](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/pretrnd_enc/README.md). The encoder is further fine-tuned during the sentiment transfer training.

## Instructions
- Please create a directory and mention the same in the 'dir' option in [config](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/polarity_aware_noising/config.json) file. This directory will contain the 'SRC' and 'TRG' [fields](https://torchtext.readthedocs.io/en/latest/data.html#fields), the vocabulary along with the checkpoint(s).
- Follow the [polarity aware noisy data preperation](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/prepare_noisy_data/README.md) and then [BPE process](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/data/README.md) and mention the paths in 'train_data_path', 'valid_data_path', 'test_data_path', 'train_pos_data_path', 'train_neg_data_path', 'valid_pos_data_path, 'valid_neg_data_path', 'test_pos_data_path', 'test_neg_data_path' options in [config](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/polarity_aware_noising/config.json) file.
- Please mention the directory details in the option 'pretrn_encoder' in the [config](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/polarity_aware_noising/config.json) file. This directory is where you saved the checkpoint and other details from [noisy backtranslation](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/back-translation/README.md) process.
- Other options in the [config](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/polarity_aware_noising/config.json) file is filled with the dafault values used in our experiments. Please adjust according to the requirements if required.
- Execute the [notebook](https://github.com/SOURO/polarity-denoising-sentiment-transfer/blob/main/polarity_aware_noising/trn_st.ipynb).
